Directories:
  GLB_DIR     = /scratch/eecs442f25_class_root/eecs442f25_class/jonzhe/data/objaverse_glbs/batch_4
  FEAT_DIR    = /scratch/eecs442f25_class_root/eecs442f25_class/jonzhe/output/partfield_features/batch_4
ğŸŒŸ Batch = 4, size = 200
ğŸ“ Base Dir   = /scratch/eecs442f25_class_root/eecs442f25_class/jonzhe/data
ğŸ“ Cache Dir  = /scratch/eecs442f25_class_root/eecs442f25_class/jonzhe/data/objaverse_cache (shared)
ğŸ“ Batch Out  = /scratch/eecs442f25_class_root/eecs442f25_class/jonzhe/data/objaverse_glbs/batch_4
åŠ è½½ Objaverse++ é«˜è´¨é‡åˆ—è¡¨...
âœ¨ High+Superior å…± 284634 ä¸ª
â¡ï¸ å½“å‰æ‰¹æ¬¡ UID èŒƒå›´: 800 ~ 999 (å…± 200 ä¸ª)
ğŸš€ å¼€å§‹ä¸‹è½½ï¼Œä½¿ç”¨ 64 ä¸ªè¿›ç¨‹â€¦
ğŸ‰ å®Œæˆï¼æœ¬æ‰¹æ¬¡ä¸‹è½½ 200 ä¸ª GLB â†’ /scratch/eecs442f25_class_root/eecs442f25_class/jonzhe/data/objaverse_glbs/batch_4
ğŸ“Œ Running PartField inference...
/home/jonzhe/.conda/envs/partfield/lib/python3.10/site-packages/lightning/fabric/__init__.py:40: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[rank: 0] Seed set to 0
Using 16bit Automatic Mixed Precision (AMP)
/home/jonzhe/.conda/envs/partfield/lib/python3.10/site-packages/lightning/pytorch/plugins/precision/amp.py:55: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/home/jonzhe/.conda/envs/partfield/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/logger_connector.py:75: Starting from v1.9.0, `tensorboardX` has been removed as a dependency of the `lightning.pytorch` package, due to potential conflicts with other packages in the ML ecosystem. For this reason, `logger=True` will use `CSVLogger` as the default logger, unless the `tensorboard` or `tensorboardX` packages are found. Please `pip install lightning[extra]` or one of them to enable TensorBoard support by default
You are using a CUDA device ('NVIDIA A100 80GB PCIe MIG 3g.40gb') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[rank: 0] Seed set to 0
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
[W1121 11:08:15.051655244 socket.cpp:697] [c10d] The client socket cannot be initialized to connect to [gl1250.arc-ts.umich.edu]:17564 (errno: 97 - Address family not supported by protocol).
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

Restoring states from the checkpoint path at model/model_objaverse.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [MIG-98141577-d909-5297-b01a-7934dd19952d]
Loaded model weights from the checkpoint at model/model_objaverse.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
/home/jonzhe/.conda/envs/partfield/lib/python3.10/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 32 worker processes in total. Our suggested max number of worker in current system is 8, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
val dataset len: 200
Predicting: |          | 0/? [00:00<?, ?it/s]Predicting:   0%|          | 0/200 [00:00<?, ?it/s]Predicting DataLoader 0:   0%|          | 0/200 [00:00<?, ?it/s]/home/jonzhe/442/PartField/partfield/model/PVCNN/pv_module/voxelization.py:17: UserWarning: The reduce argument of torch.scatter with Tensor src is deprecated and will be removed in a future PyTorch release. Use torch.scatter_reduce instead for more reduction options. (Triggered internally at ../aten/src/ATen/native/TensorAdvancedIndexing.cpp:231.)
  out_feature = result.scatter_(index=indices.long(), src=features, dim=2, reduce='add')
/home/jonzhe/.conda/envs/partfield/lib/python3.10/site-packages/lightning/pytorch/loops/prediction_loop.py:255: predict returned None if it was on purpose, ignore this warning...
Time elapsed for feature prediction: 3.04827618598938
torch.Size([14060, 451])
Time elapsed: 15.596011638641357
Predicting DataLoader 0:   0%|          | 1/200 [00:15<51:44,  0.06it/s]Time elapsed for feature prediction: 0.562171459197998
torch.Size([10115, 451])
Time elapsed: 5.802862167358398
Predicting DataLoader 0:   1%|          | 2/200 [00:21<35:19,  0.09it/s]Time elapsed for feature prediction: 0.264420747756958
torch.Size([3656, 451])
Time elapsed: 1.0972867012023926
Predicting DataLoader 0:   2%|â–         | 3/200 [00:22<24:37,  0.13it/s]Time elapsed for feature prediction: 4.254626274108887
torch.Size([87720, 451])
Time elapsed: 11.285592794418335
Predicting DataLoader 0:   2%|â–         | 4/200 [00:35<28:38,  0.11it/s]Time elapsed for feature prediction: 4.257580280303955
torch.Size([87720, 451])
Time elapsed: 9.278469324111938
Predicting DataLoader 0:   2%|â–         | 5/200 [00:44<28:50,  0.11it/s]before preprocessing...
(3508682, 3)
(3182715, 3)
Too much vertices! Skip this glb
before preprocessing...
(1041985, 3)
(429592, 3)
Too much vertices! Skip this glb
before preprocessing...
(50621, 3)
(87720, 3)
before preprocessing...
(11130, 3)
(14402, 3)
before preprocessing...
(26472, 3)
(33167, 3)
before preprocessing...
(1041985, 3)
(429592, 3)
Too much vertices! Skip this glb
before preprocessing...
(50621, 3)
(87720, 3)
before preprocessing...
(5542, 3)
(8954, 3)
before preprocessing...
(2301385, 3)
(2590339, 3)
Too much vertices! Skip this glb
before preprocessing...
(672754, 3)
(712825, 3)
Too much vertices! Skip this glb
before preprocessing...
(78001, 3)
(132696, 3)
before preprocessing...
(89860, 3)
(65680, 3)
before preprocessing...
(7819, 3)
(11164, 3)
before preprocessing...
(591, 3)
(383, 3)
before preprocessing...
(33434, 3)
(39418, 3)
before preprocessing...
(680, 3)
(868, 3)
before preprocessing...
(788, 3)
(764, 3)
before preprocessing...
(25856, 3)
(37164, 3)
before preprocessing...
(1243, 3)
(942, 3)
before preprocessing...
(20531, 3)
(26988, 3)
before preprocessing...
(339144, 3)
(515018, 3)
Too much vertices! Skip this glb
before preprocessing...
(1419, 3)
(1760, 3)
before preprocessing...
(3716, 3)
(4791, 3)
before preprocessing...
(4484, 3)
(4810, 3)
before preprocessing...
(14116, 3)
(16602, 3)
before preprocessing...
(8736, 3)
(12541, 3)
before preprocessing...
(49048, 3)
(89346, 3)
before preprocessing...
(123538, 3)
(171715, 3)
before preprocessing...
(398, 3)
(288, 3)
before preprocessing...
(25246, 3)
(23668, 3)
before preprocessing...
(4956, 3)
(9900, 3)
before preprocessing...
(8007, 3)
(11593, 3)
before preprocessing...
(17176, 3)
(10115, 3)
before preprocessing...
(109875, 3)
(169841, 3)
before preprocessing...
(9794, 3)
(15334, 3)
before preprocessing...
(107424, 3)
(173570, 3)
before preprocessing...
(412631, 3)
(690646, 3)
Too much vertices! Skip this glb
before preprocessing...
(1243, 3)
(942, 3)
before preprocessing...
(852833, 3)
(1406150, 3)
Too much vertices! Skip this glb
before preprocessing...
(20531, 3)
(26988, 3)
before preprocessing...
(25321, 3)
(29826, 3)
before preprocessing...
(1939, 3)
(1068, 3)
before preprocessing...
(788, 3)
(764, 3)
before preprocessing...
(11288, 3)
(17364, 3)
before preprocessing...
(1394, 3)
(840, 3)
before preprocessing...
(6744, 3)
(3372, 3)
before preprocessing...
(6139, 3)
(11646, 3)
before preprocessing...
(7691, 3)
(13392, 3)
before preprocessing...
(39127, 3)
(57843, 3)
before preprocessing...
(410, 3)
(284, 3)
before preprocessing...
(7948, 3)
(15000, 3)
before preprocessing...
(126419, 3)
(133861, 3)
Too much vertices! Skip this glb
before preprocessing...
(788, 3)
(764, 3)
before preprocessing...
(5504, 3)
(4916, 3)
before preprocessing...
(37831, 3)
(71128, 3)
before preprocessing...
(2679, 3)
(3692, 3)
before preprocessing...
(17129, 3)
(32284, 3)
before preprocessing...
(220469, 3)
(425642, 3)
Too much vertices! Skip this glb
before preprocessing...
(1394, 3)
(840, 3)
before preprocessing...
(788, 3)
(764, 3)
before preprocessing...
(187886, 3)
(286297, 3)
Too much vertices! Skip this glb
before preprocessing...
(8007, 3)
(11593, 3)
before preprocessing...
(318, 3)
(162, 3)
before preprocessing...
(3785, 3)
(5544, 3)
before preprocessing...
(8617, 3)
(5204, 3)
before preprocessing...
(10832, 3)
(17260, 3)
before preprocessing...
(746798, 3)
(1449604, 3)
Too much vertices! Skip this glb
before preprocessing...
(254183, 3)
(149307, 3)
Too much vertices! Skip this glb
before preprocessing...
(109875, 3)
(169841, 3)
before preprocessing...
(631, 3)
(366, 3)
before preprocessing...
(740, 3)
(1136, 3)
before preprocessing...
(1448, 3)
(1984, 3)
before preprocessing...
(6961, 3)
(6900, 3)
before preprocessing...
(1419, 3)
(1760, 3)
before preprocessing...
(7036, 3)
(14060, 3)
before preprocessing...
(254183, 3)
(149307, 3)
Too much vertices! Skip this glb
before preprocessing...
(109875, 3)
(169841, 3)
before preprocessing...
(120, 3)
(60, 3)
before preprocessing...
(50621, 3)
(87720, 3)
before preprocessing...
(59360, 3)
(99123, 3)
before preprocessing...
(672754, 3)
(712825, 3)
Too much vertices! Skip this glb
before preprocessing...
(78001, 3)
(132696, 3)
Time elapsed for feature prediction: 4.265549421310425
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/jonzhe/442/PartField/partfield_inference.py", line 57, in <module>
[rank0]:     main()
[rank0]:   File "/home/jonzhe/442/PartField/partfield_inference.py", line 54, in main
[rank0]:     predict(cfg)
[rank0]:   File "/home/jonzhe/442/PartField/partfield_inference.py", line 48, in predict
[rank0]:     trainer.predict(model, ckpt_path=cfg.continue_ckpt)
[rank0]:   File "/home/jonzhe/.conda/envs/partfield/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 863, in predict
[rank0]:     return call._call_and_handle_interrupt(
[rank0]:   File "/home/jonzhe/.conda/envs/partfield/lib/python3.10/site-packages/lightning/pytorch/trainer/call.py", line 43, in _call_and_handle_interrupt
[rank0]:     return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
[rank0]:   File "/home/jonzhe/.conda/envs/partfield/lib/python3.10/site-packages/lightning/pytorch/strategies/launchers/subprocess_script.py", line 105, in launch
[rank0]:     return function(*args, **kwargs)
[rank0]:   File "/home/jonzhe/.conda/envs/partfield/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 902, in _predict_impl
[rank0]:     results = self._run(model, ckpt_path=ckpt_path)
[rank0]:   File "/home/jonzhe/.conda/envs/partfield/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 986, in _run
[rank0]:     results = self._run_stage()
[rank0]:   File "/home/jonzhe/.conda/envs/partfield/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 1027, in _run_stage
[rank0]:     return self.predict_loop.run()
[rank0]:   File "/home/jonzhe/.conda/envs/partfield/lib/python3.10/site-packages/lightning/pytorch/loops/utilities.py", line 182, in _decorator
[rank0]:     return loop_run(self, *args, **kwargs)
[rank0]:   File "/home/jonzhe/.conda/envs/partfield/lib/python3.10/site-packages/lightning/pytorch/loops/prediction_loop.py", line 124, in run
[rank0]:     self._predict_step(batch, batch_idx, dataloader_idx, dataloader_iter)
[rank0]:   File "/home/jonzhe/.conda/envs/partfield/lib/python3.10/site-packages/lightning/pytorch/loops/prediction_loop.py", line 253, in _predict_step
[rank0]:     predictions = call._call_strategy_hook(trainer, "predict_step", *step_args)
[rank0]:   File "/home/jonzhe/.conda/envs/partfield/lib/python3.10/site-packages/lightning/pytorch/trainer/call.py", line 309, in _call_strategy_hook
[rank0]:     output = fn(*args, **kwargs)
[rank0]:   File "/home/jonzhe/.conda/envs/partfield/lib/python3.10/site-packages/lightning/pytorch/strategies/strategy.py", line 438, in predict_step
[rank0]:     return self.lightning_module.predict_step(*args, **kwargs)
[rank0]:   File "/home/jonzhe/.conda/envs/partfield/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank0]:     return func(*args, **kwargs)
[rank0]:   File "/home/jonzhe/442/PartField/partfield/model_trainer_pvcnn_only_demo.py", line 265, in predict_step
[rank0]:     np.save(f'{save_dir}/part_feat_coord_{uid}_{view_id}_batch.npy', per_face_coord_feat(part_planes, tensor_vertices, n_point_per_face, self.cfg.n_sample_each).cpu().numpy())
[rank0]:   File "/home/jonzhe/442/PartField/partfield/model_trainer_pvcnn_only_demo.py", line 204, in per_face_coord_feat
[rank0]:     sampled_feature = sample_triplane_feat(part_planes, v_slice)  # (1, n_slice_points, latent_dim)
[rank0]:   File "/home/jonzhe/442/PartField/partfield/model/PVCNN/encoder_pc.py", line 106, in sample_triplane_feat
[rank0]:     torch.cat(
[rank0]:   File "/home/jonzhe/.conda/envs/partfield/lib/python3.10/site-packages/torch/utils/data/_utils/signal_handling.py", line 67, in handler
[rank0]:     _error_if_any_worker_fails()
[rank0]: RuntimeError: DataLoader worker (pid 3098603) is killed by signal: Killed. 
Predicting DataLoader 0:   2%|â–         | 5/200 [00:51<33:20,  0.10it/s]ğŸ“¦ Compressing results in /scratch/eecs442f25_class_root/eecs442f25_class/jonzhe/output/partfield_features/batch_4 ...
./part_feat_coord_022d450a32a443cdb2b1b38721c04f10_0_batch.npy
./part_feat_coord_0235effaa2704355bc4da280c6e7fee1_0_batch.npy
./part_feat_coord_02452dd650774e8899a9c637973250e8_0_batch.npy
./part_feat_coord_0279c25ef4884f99af7894f9a0710331_0_batch.npy
ğŸ“¦ Created archive: partfield_batch_4.tar.gz
ğŸ” SHA256 saved  : partfield_batch_4.tar.gz.sha256
ğŸ§¹ Cleaning original .npy files...
ğŸ‰ All done!
slurmstepd: error: Detected 1 oom_kill event in StepId=36582564.batch. Some of the step tasks have been OOM Killed.
